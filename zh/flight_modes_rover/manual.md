# 手动模式

手动模式需要用户通过摇杆输入来控制机体。

![手动控制](../../assets/flight_modes/rover_manual_controls.png)

在所有手动模式中，摇杆提供相同的"高层级"控制效果：

| 车体类型    | 左摇杆上下控制                                                                 | 左摇杆左右控制                                                                                                                  | 右摇杆左右控制                                                                                                                  |
|-------------|-------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| Ackermann   | 控制车体前后移动（控制速度）                                                  | -                                                                                                                               | 控制左右转向（在[手动模式](#manual-mode)中控制转向角度，在[特技模式](#acro-mode)、[稳定模式](#stabilized-mode)和[定位模式](#position-mode)中控制偏航率） |
| 差速转向    | 控制车体前后移动（控制速度）。                                                  | -                                                                                                                               | 控制左右转向（在[手动模式](#manual-mode)中控制差速速度，在[特技模式](#acro-mode)、[稳定模式](#stabilized-mode)和[定位模式](#position-mode)中控制偏航率） |
| 麦克纳姆轮  | 控制车体前后移动（控制速度）                                                  | 控制左右转向（在[手动模式](#manual-mode)中控制差速速度，在[特技模式](#acro-mode)、[稳定模式](#stabilized-mode)和[定位模式](#position-mode)中控制偏率） | 控制车体左右移动（控制速度）                                                                                                    |

手动模式提供逐步增加的自动驾驶仪支持，用于保持航向、速度和转向率，补偿坡度或不平地形等外部因素的影响。

| 模式                                    | 描述                                                                                                                                                   |
| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [手动模式](manual.md#manual-mode)       | 无自动驾驶仪支持。用户需负责保持车体在预期航线上并维持速度和转向率。                                                                                     |
| [特技模式](manual.md#acro-mode)         | + 维持偏航率（感觉更像驾驶汽车而非手动模式）<br>+ 允许限制最大偏航率（防止侧翻）                                                                         |
| [稳定模式](manual.md#stabilized-mode)   | + 维持偏航（保持直线效果显著提升）                                                                                                                       |
| [定位模式](manual.md#position-mode)     | + 维持航向（最适合直线驾驶的模式）<br>+ 维持速度以抵消干扰，例如爬坡时<br>+ 允许限制最大速度                                                               |

::: details 模式映射到控制效果概述

| 模式                          | 速度                                                                                         | 转向                                                                                                                                                                                                 | 所需测量数据                          |
| ----------------------------- | -------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------- |
| [手动模式](#manual-mode)      | 直接将摇杆输入映射到电机指令。                                                                 | 直接将摇杆输入映射到转向角度/差速速度。                                                                                                                                                                | 无。                                  |
| [特技模式](#acro-mode)        | 直接将摇杆输入映射到电机指令。                                                                 | 摇杆输入创建偏航率设定值供控制系统调节。                                                                                                                                                               | 偏航率。                              |
| [稳定模式](#stabilized-mode)  | 直接将摇杆输入映射到电机指令。                                                                 | 摇杆输入创建偏航率设定值供控制系统调节。如果该设定值为零（摇杆居中），控制系统将维持当前偏航（航向）。                                                                                                 | 偏航率和偏航。                        |
| [定位模式](#position-mode)    | 摇杆输入创建速度设定值供控制系统调节。                                                       | 摇杆输入创建偏航率设定值供控制系统调节。如果该设定值为零（摇杆居中），控制系统将保持车体直线行驶。                                                                                                     | 偏航率、偏航、速度和全局位置（GPS）。 |

:::# 手动模式

在此模式下，摇杆输入直接映射到电机指令。
底盘不会尝试维持特定姿态或补偿外部因素（如坡度或不平坦地形）！
用户需负责通过调整摇杆输入来保持底盘在期望路径上。

| 底盘类型   | 左摇杆上下                         | 左摇杆左右              | 右摇杆左右                         |
| ---------- | ---------------------------------- | ----------------------- | ---------------------------------- |
| Ackermann  | 驱动底盘前进/后退。                | -                       | 调整转向角度至左/右。              |
| Differential | 驱动底盘前进/后退。              | -                       | 使底盘朝左/右偏航。                |
| Mecanum    | 驱动底盘前进/后退。                | 使底盘朝左/右偏航。     | 驱动底盘左/右移动。                |

有关此模式的配置/调参，请参见 [基础设置](../config_rover/basic_setup.md)。

## Acro模式

::: info  
该模式需要偏航率测量。  
:::

在该模式下，机体调节其偏航率以达到设定值（但不会稳定航向或调节速度）。

| 车体类型       | 左摇杆上下                         | 左摇杆左右                                                                                                         | 右摇杆左右                                                                                                                                                          |
|----------------|------------------------------------|--------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ackermann      | 控制车体前进/后退。              | -                                                                                                                  | 为控制系统创建偏航率设定值。如果此输入为零，控制系统将尝试维持零偏航率（最小干扰抑制）。                                                                             |
| Differential   | 控制车体前进/后退。              | -                                                                                                                  | 为控制系统创建偏航率设定值。如果此输入为零，控制系统将尝试维持零偏航率（最小干扰抑制）                                                                              |
| Mecanum        | 控制车体前进/后退。              | 为控制系统创建偏航率设定值。如果此输入为零，控制系统将尝试维持零偏航率（最小干扰抑制）                           | 控制车体左/右                                                                                                                                                       |

有关此模式的配置/调优，请参见 [速率调优](../config_rover/rate_tuning.md)。

## Stabilized Mode

::: info
此模式需要偏航率和偏航估计。
:::

在此模式下，机体通过设定点调节其偏航率，并在设定点为零时保持当前航向（但不调节速度）。  
与[Acro模式](#acro-mode)相比，该模式在直线行驶方面表现更优，因为它能更有效地抑制干扰。

| Rover Type   | 左摇杆上下移动                  | 左摇杆左右移动                                                                                                                  | 右摇杆左右移动                                                                                                                 |
| ------------ | ----------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| Ackermann    | 控制车辆前进/后退。 | -                                                                                                                                      | 为控制系统生成偏航率设定点。当此输入为零时，控制系统将保持当前偏航角。 |
| Differential | 控制车辆前进/后退。 | -                                                                                                                                      | 为控制系统生成偏航率设定点。当此输入为零时，控制系统将保持当前偏航角。 |
| Mecanum      | 控制车辆前进/后退。 | 为控制系统生成偏航率设定点。当此输入为零时，控制系统将保持当前偏航角。 | 控制车辆左/右移动                                                                                                             |

该模式的配置/调参请参见[姿态调参](../config_rover/attitude_tuning.md)。

## 位置模式

::: info
此模式需要偏航率、偏航角、速度和全局位置估计。
:::

这是具备最多自主飞行器支持的手动模式。机体通过控制偏航率和速度来实现设定值。如果偏航率设定值为零，控制器将记住GPS坐标和机体偏航角（航向角），并利用这些信息构建一条供探测器跟踪的路线（航向控制）。这提供了最强的干扰抑制能力，从而实现最佳的直线行驶行为。

| 探测器类型   | 左操纵杆上下                                                                                           | 左操纵杆左右                                                                                                                           | 右操纵杆左右                                                                                                                           |
| ------------ | ------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| Ackermann    | 操纵杆位置设置前进/后退速度设定值。机体尝试在斜坡等情况下保持该速度。                                 | -                                                                                                                                      | 为控制系统创建偏航率设定值。如果此输入为零，控制系统将保持探测器的航向。                                                               |
| Differential | 操纵杆位置设置前进/后退速度设定值。机体尝试在斜坡等情况下保持该速度。                                 | -                                                                                                                                      | 为控制系统创建偏航率设定值。如果此输入为零，控制系统将保持探测器的航向。                                                               |
| Mecanum      | 操纵杆位置设置前进/后退速度设定值。机体尝试在斜坡等情况下保持该速度。                                 | 为控制系统创建偏航率设定值。如果此输入为零，控制系统将保持探测器的航向。                                                               | 操纵杆位置设置左/右速度设定值。机体尝试在斜坡等情况下保持该速度。                                                                      |

关于此模式的配置/调参，请参见[速度调节](../config_rover/velocity_tuning.md)。