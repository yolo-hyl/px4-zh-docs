

# PX4-Autopilot v1.16.0 版本说明

<Badge type="info" text="Candidate Release" />

<script setup>
import { useData } from 'vitepress'
const { site } = useData();
</script>

<div v-if="site.title !== 'PX4 Guide (main)'">
  <div class="custom-block danger">
    <p class="custom-block-title">此页面位于发布分支上，因此可能已过时。 <a href="https://docs.px4.io/main/en/releases/main.html">查看最新版本</a>。</p>
  </div>
</div>

本文档涵盖PX4 v1.16.0自上一个稳定版本([PX4 v1.15.0](../releases/1.15.md))以来的所有变更内容。

::: info
这些说明仅包含2023年及之后合并的变更 - 2023年之前的提交未列出。
:::

## 升级前请阅读

请继续阅读以下[升级指南](#升级指南)。

## 重大变更

- **Rover支持重构**
  - 新的专用固件构建用于Rover（机架ID 50000-52000）
  - 针对Ackermann、差速和麦卡纳姆Rover的独立模块，每个模块均包含手动、特技、稳定、定位和自动模式
  - 所有Rover模块共享的纯追踪引导库
  - 旧版Rover定位控制模块已被弃用，推荐使用新模块

## 升级指南

- [PX4-Autopilot#24648](https://github.com/PX4/PX4-Autopilot/pull/24648): 为VOXL 2板的EKF2_EV_CTRL设置默认值15
- [PX4-Autopilot#22517](https://github.com/PX4/PX4-Autopilot/pull/22517): 更改默认以太网IP
- [PX4-Autopilot#24602](https://github.com/PX4/PX4-Autopilot/pull/24602): 从sf45模块中移除串口默认值

## 其他变更

### 硬件支持

- **[New Hardware]** [PX4-Autopilot#23830](https://github.com/PX4/PX4-Autopilot/pull/23830): Boards: ARK FPV FC  
- **[New Hardware]** [PX4-Autopilot#23414](https://github.com/PX4/PX4-Autopilot/pull/23414): board: add cuav 7-nano  
- **[New Hardware]** [PX4-Autopilot#24769](https://github.com/PX4/PX4-Autopilot/pull/24769): add new board corvon743v1  
- **[New Hardware]** [PX4-Autopilot#24018](https://github.com/PX4/PX4-Autopilot/pull/24018): boards: bluerobotics: navigator: Add initial support  
- **[New Hardware]** [PX4-Autopilot#24147](https://github.com/PX4/PX4-Autopilot/pull/24147): boards: add new board micoair743-v2  
- **[New Hardware]** [PX4-Autopilot#23218](https://github.com/PX4/PX4-Autopilot/pull/23218): boards: add new board micoair h743  
- **[New Hardware]** [PX4-Autopilot#24512](https://github.com/PX4/PX4-Autopilot/pull/24512): boards: Add FMUv6s target  
- **[New Hardware]** [PX4-Autopilot#23927](https://github.com/PX4/PX4-Autopilot/pull/23927): manifest: Add Skynode S baseboard  
- **[New Hardware]** [PX4-Autopilot#23257](https://github.com/PX4/PX4-Autopilot/pull/23257): Add Tropic VMU board support (Baseboard for Teensy 4.1)  
- **[New Hardware]** [PX4-Autopilot#23697](https://github.com/PX4/PX4-Autopilot/pull/23697): boards: add new board X-MAV AP-H743v2  
- **[New Hardware]** [PX4-Autopilot#23551](https://github.com/PX4/PX4-Autopilot/pull/23551): 3DR boards: Support for 3DR Control Zero H7 OEM Rev G  
- **[New Hardware]** [PX4-Autopilot#23623](https://github.com/PX4/PX4-Autopilot/pull/23623): new board support ZeroOne x6

### 共同内容

- [光流缩放因子 - SENS_FLOW_SCALE](../sensor/optical_flow.md#scale-factor). ([PX4-Autopilot#23936](https://github.com/PX4/PX4-Autopilot/pull/23936)).
- [PX4-Autopilot#22813](https://github.com/PX4/PX4-Autopilot/pull/22813): 重新引入可选参数版本机制，供机体维护者使用

- [电池电量估算改进](../config/battery.md). ([PX4-Autopilot#23205](https://github.com/PX4/PX4-Autopilot/pull/23205)).
  - [基于电压的负载补偿估算](../config/battery.md#voltage-based-estimation-with-load-compensation) 现在通过实时估算电池内阻来补偿负载下的电压降（高电流时），相比直接使用测量电压能提供更精确的电量估算。
  - 已移除基于推力的负载补偿（连同`BATn_V_LOAD_DROP`参数，其中`n`为电池编号）。
- [位置（GNSS）丢失安全机制](../config/safety.md#position-gnss-loss-failsafe) 的可配置延迟参数(`COM_POS_FS_DELAY`)已移除。
  现在位置丢失1秒后安全机制将触发。([PX4-Autopilot#24063](https://github.com/PX4/PX4-Autopilot/pull/24063)).
- [日志加密](../dev_log/log_encryption.md) 现在生成的加密日志包含公钥加密的对称密钥，该密钥可用于解密日志，而不是将密钥放入单独的文件中。
  这使得日志解密更加便捷，无需单独下载或识别密钥文件。
  ([PX4-Autopilot#24024](https://github.com/PX4/PX4-Autopilot/pull/24024)).
- 通用任务命令超时参数[MIS_COMMAND_TOUT](../advanced_config/parameter_reference.md#MIS_COMMAND_TOUT) 取代了特定于交付的`MIS_PD_TO`参数。
  对于可能需要较长时间完成的任务命令（如云台、绞车和夹具控制），在收到反馈或超时后将自动进入下一个任务项。
  这通常用于为不提供完成反馈的硬件提供最小延迟，确保硬件达到指令状态后再继续任务。
  ([PX4-Autopilot#23960](https://github.com/PX4/PX4-Autopilot/pull/23960)).
- **[uORB]** 为部分uORB消息引入了[版本字段](../middleware/uorb.md#message-versioning) ([PX4-Autopilot#23850](https://github.com/PX4/PX4-Autopilot/pull/23850))
- [磁力计校准](../config/compass.md) 在外部磁力计可用时会禁用内部磁力计。
  这通常能减少因磁力计不一致导致的错误警告。
  ([PX4-Autopilot#24316](https://github.com/PX4/PX4-Autopilot/pull/24316)).

### 控制

- [PX4-Autopilot#23863](https://github.com/PX4/PX4-Autopilot/pull/23863): [由ARK提供赞助] 双向DShot
- [PX4-Autopilot#24196](https://github.com/PX4/PX4-Autopilot/pull/24196): 将控制分配和执行器有效性变为非模块特定的库
- [PX4-Autopilot#24221](https://github.com/PX4/PX4-Autopilot/pull/24221): 航天器构建和基础控制分配器

- 通过 `MC_ORBIT_YAW_MOD` 可配置多旋翼轨道模式偏航 ([PX4-Autopilot#23358](https://github.com/PX4/PX4-Autopilot/pull/23358))
- 碰撞预防功能现在支持手动（基于加速度的）飞行模式 (`MPC_POS_MODE`) ([PX4-Autopilot#23507](https://github.com/PX4/PX4-Autopilot/pull/23507))

### 估计

- [PX4-Autopilot#23854](https://github.com/PX4/PX4-Autopilot/pull/23854): EKF2：椭球地球导航
- [PX4-Autopilot#23263](https://github.com/PX4/PX4-Autopilot/pull/23263): EKF2：地形状态
- [PX4-Autopilot#23185](https://github.com/PX4/PX4-Autopilot/pull/23185): ekf2：添加磁力计类型初始化
- [PX4-Autopilot#23436](https://github.com/PX4/PX4-Autopilot/pull/23436): ekf2：光学流默认启用

- 位置丢失安全延迟已移除；在丢失1秒后触发（见Common）

### 传感器

- [PX4-Autopilot#23656](https://github.com/PX4/PX4-Autopilot/pull/23656): 实现AUAV绝对/差压传感器支持  
- [PX4-Autopilot#23639](https://github.com/PX4/PX4-Autopilot/pull/23639): 实现INA228 / INA238温度传感器支持  
- [PX4-Autopilot#22744](https://github.com/PX4/PX4-Autopilot/pull/22744): 增加Ublox ZED-F9P-15B支持  
- [PX4-Autopilot#24316](https://github.com/PX4/PX4-Autopilot/pull/24316): 磁力计校准：当外部磁力计可用时自动禁用内部磁力计  
- [PX4-Autopilot#23064](https://github.com/PX4/PX4-Autopilot/pull/23064): BMP581: 增加Bosch BMP581气压计支持  
- [PX4-Autopilot#22914](https://github.com/PX4/PX4-Autopilot/pull/22914): Murata SCH16T IMU驱动程序  
- [PX4-Autopilot#23023](https://github.com/PX4/PX4-Autopilot/pull/23023): ST IIS2MDC磁力计驱动程序  
- [PX4-Autopilot#24121](https://github.com/PX4/PX4-Autopilot/pull/24121): 在dds话题中包含距离传感器  
- [PX4-Autopilot#23925](https://github.com/PX4/PX4-Autopilot/pull/23925): 驱动程序: 磁力计: mmc5983ma: 增加SPI支持  
- [PX4-Autopilot#23909](https://github.com/PX4/PX4-Autopilot/pull/23909): 驱动程序/磁力计/ak09916: 增加对AK09915的支持  
- [PX4-Autopilot#23362](https://github.com/PX4/PX4-Autopilot/pull/23362): 增加Bosch BMM350磁力计  

- [PX4-Autopilot#24316](https://github.com/PX4/PX4-Autopilot/pull/24316): 磁力计校准现在在检测到外部设备时自动禁用内部磁力计，减少误报警告

### 仿真

- **SIH**:
  - SITL中的SIH [自定义起飞位置](../sim_sih/index.md#set-custom-takeoff-location) 现在使用正常的未缩放GPS位置值进行设置，而之前需要将值乘以1E7。
    ([PX4-Autopilot#23363](https://github.com/PX4/PX4-Autopilot/pull/23363))。
  - SIH现在支持标准的垂直起降(VTOL)机体
    ([PX4-Autopilot#24175](https://github.com/PX4/PX4-Autopilot/pull/24175))。
- **Gazebo**:
  - Gazebo Harmonic LTS版本已取代Gazebo Garden成为PX4支持的版本。默认安装脚本（用于CI）和文档已更新。这是由于Garden的生命周期将在2024年11月结束。
    ([PX4-Autopilot#23603](https://github.com/PX4/PX4-Autopilot/pull/23603))
  - 新机体模型 `x500_lidar_2d` — [x500 四旋翼飞行器配备2D激光雷达](../sim_gazebo_gz/vehicles.md#x500-quadrotor-with-2d-lidar)。([PX4-Autopilot#22418](https://github.com/PX4/PX4-Autopilot/pull/22418), [PX4-gazebo-models#41](https://github.com/PX4/PX4-gazebo-models/pull/41)).
  - 新机体模型 `x500_lidar_front` — [X500 四旋翼飞行器配备1D激光雷达(前向)](../sim_gazebo_gz/vehicles.md#x500-quadrotor-with-1d-lidar-front-facing)。([PX4-Autopilot#23879](https://github.com/PX4/PX4-Autopilot/pull/23879), [PX4-gazebo-models#62](https://github.com/PX4/PX4-gazebo-models/pull/62/files)).
  - 新机体模型 `x500_lidar_down` — [X500 四旋翼飞行器配备1D激光雷达(下向)](../sim_gazebo_gz/vehicles.md#x500-quadrotor-with-1d-lidar-down-facing)。([PX4-Autopilot#23879](https://github.com/PX4/PX4-Autopilot/pull/23879), [PX4-gazebo-models#62](https://github.com/PX4/PX4-gazebo-models/pull/62/files)).
  - 新机体模型 `r1_rover` — [Aion Robotics R1 Rover](../sim_gazebo_gz/vehicles.md#differential-rover) ([PX4-Autopilot#22402](https://github.com/PX4/PX4-Autopilot/pull/22402) 和 [PX4-gazebo-models#21](https://github.com/PX4/PX4-gazebo-models/pull/21)).
  - 新机体模型 `rover_ackermann` — [Ackermann Rover](../sim_gazebo_gz/vehicles.md#ackermann-rover) ([PX4-Autopilot#23383](https://github.com/PX4/PX4-Autopilot/pull/23383) 和 [PX4-gazebo-models#46](https://github.com/PX4/PX4-gazebo-models/pull/46)).
  - 新机体模型 `x500_gimbal` — [四旋翼(x500)配备云台(前向)](../sim_gazebo_gz/vehicles.md#x500-quadrotor-with-gimbal-front-facing) ([PX4-Autopilot#23382](https://github.com/PX4/PX4-Autopilot/pull/23382) 和 [PX4-gazebo-models#47](https://github.com/PX4/PX4-gazebo-models/pull/47) 和 [PX4-gazebo-models#70](https://github.com/PX4/PX4-gazebo-models/pull/70)).
  - 新机体模型 `quadtailsitter` — [四旋翼尾座式VTOL](../sim_gazebo_gz/vehicles.md#quad-tailsitter-vtol) ([PX4-Autopilot#23943](https://github.com/PX4/PX4-Autopilot/pull/23943) 和 [PX4-gazebo-models#65](https://github.com/PX4/PX4-gazebo-models/pull/65)).
  - 新机体模型 `tiltrotor` — [倾转旋翼VTOL](../sim_gazebo_gz/vehicles.md#tiltrotor-vtol) ([PX4-Autopilot#24028](https://github.com/PX4/PX4-Autopilot/pull/24028) 和 [PX4-gazebo-models#66](https://github.com/PX4/PX4-gazebo-models/pull/66)).
  - [实时加速仿真](../simulation/index.md#simulation_speed) ([PX4-Autopilot#24421](https://github.com/PX4/PX4-Autopilot/pull/24421), [PX4-Autopilot#23783](https://github.com/PX4/PX4-Autopilot/pull/23783))
  - [PX4-Autopilot#24471](https://github.com/PX4/PX4-Autopilot/pull/24471): Gazebo: 移动平台

### uXRCE-DDS / ROS2

- **[特性]** [PX4-Autopilot#24113](https://github.com/PX4/PX4-Autopilot/pull/24113): <Badge type="warning" text="Experimental"/> [ROS 2消息转换节点](../ros2/px4_ros2_msg_translation_node.md) 用于动态转换PX4消息的不同定义版本
- [PX4-Autopilot#24582](https://github.com/PX4/PX4-Autopilot/pull/24582): dds_topics: add vtol_vehicle_status
- [PX4-Autopilot#24583](https://github.com/PX4/PX4-Autopilot/pull/24583): dds_topics: add home_position

### MAVLink

- 待定

### 多旋翼

- [PX4-Autopilot#24173](https://github.com/PX4/PX4-Autopilot/pull/24173): [多旋翼] 添加偏航扭矩低通滤波器
- [PX4-Autopilot#23943](https://github.com/PX4/PX4-Autopilot/pull/23943): 添加四轴尾座的gz模型

- [PX4-Autopilot#23358](https://github.com/PX4/PX4-Autopilot/pull/23358): 允许通过参数 [MC_ORBIT_YAW_MOD](../advanced_config/parameter_reference.md#MC_ORBIT_YAW_MOD) 配置系统默认的 [多旋翼轨道模式](../flight_modes_mc/orbit.md) 偏航行为
- [PX4-Autopilot#23507](https://github.com/PX4/PX4-Autopilot/pull/23507): 适配 [Collision Prevention](../computer_vision/collision_prevention.md) 实现以在默认手动飞行模式（基于加速度）[MPC_POS_MODE](../advanced_config/parameter_reference.md#MPC_POS_MODE) 下工作。

### 垂直起降

- 待定

### 固定翼

- [PX4-Autopilot#24167](https://github.com/PX4/PX4-Autopilot/pull/24167): 固定翼：修复车轮控制器
- [PX4-Autopilot#23520](https5://github.com/PX4/PX4-Autopilot/pull/23520): 固定翼：允许在没有有效全局位置的情况下进行位置控制

- 改进：固定翼自动起飞：启用为手动/弹射起飞设置起飞襟翼。[PX4-Autopilot#23460](https://github.com/PX4/PX4-Autopilot/pull/23460)

### 地面机器人

此次发布包含对PX4中地面机器人支持的全面重构：

- 重新构建了[地面机器人相关文档](../frames_rover/index.md)  
- 针对[地面机器人](../config_rover/index.md#flashing-the-rover-build)的专用固件构建  
- 针对[Ackermann地面机器人](../frames_rover/index.md#ackermann)的专用模块：  
  - 当前模块支持[手动模式](../flight_modes_rover/manual.md#manual-mode)、[特技模式](../flight_modes_rover/manual.md#acro-mode)、[稳定模式](../flight_modes_rover/manual.md#stabilized-mode)、[位置模式](../flight_modes_rover/manual.md#position-mode)和[自动模式](../flight_modes_rover/auto.md)  
- 针对[差速地面机器人](../frames_rover/index.md#differential)的专用模块：  
  - 当前模块支持[手动模式](../flight_modes_rover/manual.md#manual-mode)、[特技模式](../flight_modes_rover/manual.md#acro-mode)、[稳定模式](../flight_modes_rover/manual.md#stabilized-mode)、[位置模式](../flight_modes_rover/manual.md#position-mode)和[自动模式](../flight_modes_rover/auto.md)  
- 针对[麦卡纳姆地面机器人](../frames_rover/index.md#mecanum)的专用模块：  
  - 当前模块支持[手动模式](../flight_modes_rover/manual.md#manual-mode)、[特技模式](../flight_modes_rover/manual.md#acro-mode)、[稳定模式](../flight_modes_rover/manual.md#stabilized-mode)、[位置模式](../flight_modes_rover/manual.md#position-mode)和[自动模式](../flight_modes_rover/auto.md)  
- 新增了针对Ackermann、差速和麦卡纳姆地面机器人的专用固件构建（`50000–52000`）  
- 重新构建了[地面机器人机架](../airframes/airframe_reference.md#rover)的编号规范 ([PX4-Autopilot#23506](https://github.com/PX4/PX4-Autopilot/pull/23506))。  
  此次重构新增了以下[地面机器人机架](../airframes/airframe_reference.md#rover)：  
  - 通用差速地面机器人 `50000`  
  - 通用Ackermann地面机器人 `51000`  
  - Axial SCX10 2 Trail Honcho `51001`  
  - 通用麦卡纳姆地面机器人 `52000`  
- 所有地面机器人模块共享的[pure pursuit guidance algorithm](../config_rover/position_tuning.md#pure-pursuit-guidance-logic-info-only)算法库  
- 在gazebo中为差速转向和Ackermann地面机器人新增了[仿真](../frames_rover/index.md#simulation)（版本说明请参见simulation中的`r1_rover`和`rover_ackermann`）  
- [地面机器人位置控制](../frames_rover/rover_position_control.md)模块已被弃用：注意旧版地面机器人模块仍然存在，但已被新专用模块取代

### 基础设施

- [PX4-Autopilot#24011](https://github.com/PX4/PX4-Autopilot/pull/24011): 标准模式：添加适用于特定机体类型的默认模式  
- [PX4-Autopilot#24020](https://github.com/PX4/PX4-Autopilot/pull/24020): 持续集成：构建所有并上传到发布版本  
- [PX4-Autopilot#24002](https://github.com/PX4/PX4-Autopilot/pull/24002): 持续集成：px4-dev 容器  
- [PX4-Autopilot#23937](https://github.com/PX4/PX4-Autopilot/pull/23937): 持续集成：Ubuntu 24 的工作流  
- [PX4-Autopilot#23869](https://github.com/PX4/PX4-Autopilot/pull/23869): 持续集成：添加对 Ubuntu 22.04 的测试  
- [PX4-Autopilot#23574](https://github.com/PX4/PX4-Autopilot/pull/23574): 持续集成：尝试使用 Dronecode 基础设施的运行节点  
- [PX4-Autopilot#23550](https://github.com/PX4/PX4-Autopilot/pull/23550): 持续集成：替换构建工作流